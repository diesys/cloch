function getUrlVars(){var e={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(o,t,n){e[t]=n});return e}function setHour(e,o=!0){style="fade",e%=24,hour={value:e},hour.valueHex=e%6,hour.valueDodec=e%12,coords=o?hoursXY:hoursXYdodec,length=o?6:12,hour.X=coords[e%length][0],hour.Y=coords[e%length][1],transl="translate("+hour.X+"px, "+hour.Y+"px)",duration=1,mask_opacity="",config.hour=hour,e>=0&&e<=5?mask_opacity=.6:e>=6&&e<=11?opacity=0:e>=12&&e<=17?mask_opacity=.4:e>=18&&e<=23&&(mask_opacity=1),"fade"==style?(TweenMax.to(sunMoon[0],2*durationFade,{delay:0,opacity:0}),TweenMax.to(sunMoon[0],0,{delay:3*durationFade,css:{transform:transl}}),TweenMax.to(sunMoon[0],4*durationFade,{opacity:1,delay:4*durationFade,ease:Bounce.easeOut}),TweenMax.to(sunMoon[2],40*durationFade,{delay:0,opacity:mask_opacity,ease:Power2.easeOut})):"move"==style&&TweenMax.to(sunMoon[0],duration,{delay:0,ease:Power3.easeInOut,css:{transform:transl}}),config.debug&&console.log("new hour set: ",hour)}function setMinute(e,o=config.theme){if(e<60){var t=(e/5%12).toFixed(1).toString().split("."),n={value:e,indicator_index:parseInt(t[0]),opacity_index:t[1]/2};if(config.minute=n,0==e)minutes[11];else minutes[(n.indicator_index-1)%12];var c=minutes[n.indicator_index%12],l=minutes[(n.indicator_index+1)%12];for("dark"==o?colors=minutesColors:"light"==o&&(colors=minutesColorsLight),TweenMax.fromTo(c,8*durationFade,{fill:colors.first_start[n.opacity_index],delay:2*durationFade},{fill:colors.first[n.opacity_index],delay:2*durationFade}),TweenMax.fromTo(l,8*durationFade,{fill:colors.second_start[n.opacity_index],delay:2*durationFade},{fill:colors.second[n.opacity_index],delay:2*durationFade}),i=0;i<12;i++)i!=n.indicator_index&&(i%2==0?TweenMax.to(minutes[i],8*durationFade,{fill:"rgba(0,0,0,.07)",delay:0}):TweenMax.to(minutes[i],8*durationFade,{delay:0,fill:"rgba(0,0,0,.04)"}));temp_min=config.minute.value,tmp_min=temp_min<10?"0"+temp_min:temp_min,new_digital_time=config.hour.value+"<i id='digital_clock_sec_ind'>:</i>"+tmp_min,document.querySelector("#digital_clock").innerHTML=new_digital_time,config.debug&&console.log("new minute: ",e)}else console.log("error: minutes can be [0..60]")}function toggleTheme(e){e||(e=config.theme),config.debug&&console.log("curr theme",e),"dark"==e?(new_fill_sunmoon="#040404",new_theme="light"):"light"==e?(new_fill_sunmoon="#ffffff",new_theme="dark"):console.log("wrong theme..."),setMinute(config.minute.value,new_theme),TweenMax.to(sunMoon[1],.5,{fill:new_fill_sunmoon,ease:Power2.easeOut}),document.querySelector("body").classList.remove(e),document.querySelector("body").classList.add(new_theme),config.debug&&console.log("new theme",new_theme),config.theme=new_theme,updateURL()}function changeColor(e,o=.8){TweenMax.to(sunMoon[2],o,{css:{fill:e}}),TweenMax.to(background,o,{delay:0,css:{fill:e}}),document.querySelectorAll(".theme-colored").forEach(o=>{o.setAttribute("style","color:"+e+"; textShadow: rgba(0,0,0,.5) 0 0 3px;")}),document.querySelectorAll(".browser-theme-colored").forEach(t=>{TweenMax.to(t,o,{delay:0,attr:{content:e}})}),config.debug&&console.log("new color",e),config.color=e.replace(/\s/g,""),updateURL()}function updateURL(){window.history.replaceState&&window.history.replaceState({color:config.color,theme:config.theme,hex:config.hexCloch},"newclrtheme","?color="+config.color+"&theme="+config.theme+"&hex="+config.hexCloch)}function clochToggle(){clochStopped?(startstop_cloch.classList.add("fa-pause"),startstop_cloch.classList.remove("fa-play"),document.querySelector("#digital_clock").classList.remove("paused"),clochStopped=!1):(startstop_cloch.classList.add("fa-play"),startstop_cloch.classList.remove("fa-pause"),document.querySelector("#digital_clock").classList.add("paused"),clochStopped=!0)}function hide(e,o=600){e.classList.add("fake_hidden"),setTimeout(function(){e.classList.remove("fake_hidden"),e.classList.add("hidden")},o)}function show(e){e.classList.remove("hidden")}function toggleView(e){e.classList.contains("hidden")?show(e):hide(e)}function blockUserInput(e,o=600){e.classList.add("noInputEvents"),setTimeout(function(){e.classList.remove("noInputEvents")},o)}function exampleMins(e=500){clochStopped=!0,j=0,setInterval(function(){j<60&&(setMinute(j,config.theme),j++)},e)}function exampleHours(e=1300){clochStopped=!0,i=0,setInterval(function(){i<24&&(setHour(i,config.hexCloch),i++)},2*e)}function manualTime(e){new_h=parseInt(e.target.value.split(":")[0]),new_m=parseInt(e.target.value.split(":")[1]),new_h!=config.hour.value&&setHour(new_h,config.hexCloch),new_m!=config.minute.value&&setMinute(new_m),config.debug&&console.log(new_time)}minutes=[document.querySelector("#minAng_top"),document.querySelector("#minMid_rightT"),document.querySelector("#minAng_topR"),document.querySelector("#minMid_right"),document.querySelector("#minAng_bottomR"),document.querySelector("#minMid_rightB"),document.querySelector("#minAng_bottom"),document.querySelector("#minMid_leftB"),document.querySelector("#minAng_bottomL"),document.querySelector("#minMid_left"),document.querySelector("#minAng_topL"),document.querySelector("#minMid_leftT")],sunMoon=[document.querySelector("#sunmoon_indicator"),document.querySelector("#sun"),document.querySelector("#moon_mask")],hoursXY=new Array([-33.8,-19],[0,0],[0,40],[-33.8,58],[-67,38],[-67,0]),hoursXYdodec=new Array([-33.8,-19],[-15,-11],[0,0],[2,20],[0,40],[-15,51],[-33.8,58],[-52,51],[-67,38],[-70,20],[-67,0],[-52,-11]),durationFade=.1,clochStopped=!1,minutesColorsLight={first_start:["rgba(5,5,5,1)","rgba(5,5,5,1)","rgba(5,5,5,1)","rgba(5,5,5,.7)","rgba(5,5,5,.4)"],second_start:["rgba(0,0,0,.1)","rgba(5,5,5,.1)","rgba(5,5,5,.4)","rgba(5,5,5,.4)","rgba(5,5,5,.7)"],first:["rgba(5,5,5,1)","rgba(5,5,5,1)","rgba(5,5,5,.7)","rgba(5,5,5,.4)","rgba(5,5,5,.4)"],second:["rgba(0,0,0,.1)","rgba(5,5,5,.4)","rgba(5,5,5,.4)","rgba(5,5,5,.7)","rgba(5,5,5,1)"]},minutesColors={first_start:["rgba(255,255,255,1)","rgba(255,255,255,1)","rgba(255,255,255,1)","rgba(255, 255, 255, .7)","rgba(255, 255, 255, .4)"],second_start:["rgba(0,0,0,.1)","rgba(255,255,255,.1)","rgba(255,255,255,.4)","rgba(255, 255, 255, .4)","rgba(255, 255, 255, .7)"],first:["rgba(255,255,255,1)","rgba(255,255,255,1)","rgba(255,255,255,.7)","rgba(255, 255, 255, .4)","rgba(255, 255, 255, .4)"],second:["rgba(0,0,0,.1)","rgba(255,255,255,.4)","rgba(255,255,255,.4)","rgba(255, 255, 255, .7)","rgba(255, 255, 255, 1)"]},window.onload=function(){document.querySelector("#cloch").setAttribute("style","opacity: 1"),quadrant=document.querySelector("#quadranthx"),background=document.querySelector("#backgroundhx"),toggle_toolbar=document.querySelector("#toggle_toolbar"),subToolbars=document.querySelectorAll(".subtoolbar"),toolbar_buttons=document.querySelector("#toolbar_buttons"),toggle_theme=document.querySelector("#toggle_theme"),toggle_palette=document.querySelector("#toggle_palette"),palette=document.querySelector("#palette"),paletteColors=document.querySelectorAll("#palette>#colors>li"),toggle_digitalClock=document.querySelector("#toggle_digital_clock"),toggle_hex_dodec=document.querySelector("#toggle_hex_dodec"),digital_clock=document.querySelector("#digital_clock"),toggle_clock_settings=document.querySelector("#toggle_clock_settings"),clock_settings=document.querySelector("#clock_settings"),startstop_cloch=document.querySelector("#startstop_cloch"),manual_time_input=document.querySelector("#manual_time_input"),helpToggles=document.querySelectorAll(".toggleHelp"),helpPanel=document.querySelector("#help"),config=getUrlVars(),config.color||(config.color="#ff3c6d",config.first_visit=!0),config.theme||(config.theme="dark"),config.hex||(config.hexCloch=!0),date=new Date,config.hour={value:date.getHours()},config.minute={value:date.getMinutes()},setTimeout(function(){setHour(date.getHours(),config.hexCloch),setMinute(date.getMinutes(),config.theme),config.debug&&console.log("AUTO time set: ",config.hour,":",config.minute)},0),changeColor(config.color,0),toggleTheme("dark"==config.theme?"light":"dark"),setInterval(function(){clochStopped||(date=new Date,h=date.getHours(),m=date.getMinutes(),h!=config.hour.value&&setHour(h,config.sixHour),m!=config.minute.value&&setMinute(m,config.theme)),config.debug&&console.log("AUTO update time: ",h,":",m)},500),toggle_toolbar.addEventListener("click",function(){blockUserInput(toggle_toolbar),toolbar_buttons.classList.toggle("hidden"),this.classList.contains("opened")&&subToolbars.forEach(e=>{hide(e)}),toggle_toolbar.classList.toggle("opened")}),toggle_clock_settings.addEventListener("click",function(){blockUserInput(toggle_clock_settings),toggleView(clock_settings),hide(palette)}),toggle_digitalClock.addEventListener("click",function(){blockUserInput(toggle_digitalClock),toggle_digitalClock.classList.toggle("fa-eye"),toggle_digitalClock.classList.toggle("fa-eye-slash"),digital_clock.classList.toggle("hidden"),config.debug&&console.log("manual timing toggle")}),toggle_hex_dodec.addEventListener("click",function(){updateURL(),this.classList.toggle("hexCloch"),config.hexCloch^=!0,setHour(config.hour.value,config.hexCloch)}),startstop_cloch.addEventListener("click",function(){blockUserInput(startstop_cloch),clochToggle(),manual_time_input.disabled^=!0,config.debug&&console.log("start/stop toggled")}),toggle_palette.addEventListener("click",function(){blockUserInput(toggle_palette),toggleView(palette),hide(clock_settings),config.debug&&console.log("palette toggle")}),paletteColors.forEach(e=>{e.addEventListener("click",function(e){changeColor(e.target.getAttribute("data-color"))}),config.debug&&console.log("palette color chaged to:",color)}),toggle_theme.addEventListener("click",function(){toggleTheme()}),helpToggles.forEach(e=>{e.addEventListener("click",function(){blockUserInput(e),toggleView(helpPanel),hide(palette),hide(clock_settings),document.body.classList.toggle("inactive")}),config.debug&&console.log("Help toggled")}),config.first_visit&&(show(help),document.querySelector("body").classList.add("inactive"))};